<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Dungarpur Live News — Video News</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;}
body{background:#f7f7f7;color:#222;overflow-x:hidden;}

/* LIVE DOT */
.live-dot{width:10px;height:10px;background:red;border-radius:50%;margin-left:6px;animation:blink 0.8s infinite;}
@keyframes blink{0%{opacity:1;}50%{opacity:0;}100%{opacity:1;}}

/* HEADER */
header{
  background:#fff;padding:12px 15px;border-bottom:3px solid #d60000;
  position:sticky;top:0;z-index:999;
  display:flex;justify-content:space-between;align-items:center;
}
.logo{font-size:20px;font-weight:800;color:#d60000;display:flex;align-items:center;}

.time-box{font-size:12px;font-weight:600;color:#444;text-align:right;line-height:14px;}
.time-box span{color:#d60000;font-weight:700;}

/* TICKER */
.tile-ticker{
  background:#d60000;padding:10px 0;overflow:hidden;white-space:nowrap;
  display:flex;align-items:center;
}
.tile-track{
  display:inline-block;animation:scrollTiles 120s linear infinite;
}
.tile{
  background:#fff;color:#d60000;padding:6px 14px;margin-right:12px;
  border-radius:20px;font-size:13px;font-weight:700;display:inline-block;
  box-shadow:0 2px 4px rgba(0,0,0,0.2);
}
@keyframes scrollTiles{
  0%{transform:translateX(0);}
  100%{transform:translateX(-50%);}
}

/* VIDEO GRID */
.grid{
  display:grid;grid-template-columns:1fr;gap:15px;padding:0 12px;margin-top:12px;
}

.video-card{
  background:#fff;border-radius:12px;overflow:hidden;
  box-shadow:0 3px 6px rgba(0,0,0,0.1);padding-bottom:10px;
}

.video-card video{
  width:100%;height:220px;background:#000;border-bottom:3px solid #d60000;
}

.video-card h3{
  font-size:16px;color:#d60000;font-weight:700;margin:10px;
  cursor:pointer;
}

.read-more-btn{
  background:#d60000;
  color:#fff;
  padding:5px 10px;
  border-radius:6px;
  font-size:12px;
  cursor:pointer;
  margin:0 10px 10px;
  display:inline-block;
}

/* POPUP */
.popup-bg{
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:rgba(0,0,0,0.7);
  display:none;
  justify-content:center;
  align-items:center;
  padding:20px;
  z-index:9999;
}
.popup-box{
  position:relative;
  background:#fff;
  width:90%;
  max-width:420px;
  padding:20px;
  border-radius:12px;
  max-height:80vh;
  overflow:auto;
  box-shadow:0 5px 20px rgba(0,0,0,0.4);
}
.popup-box h2{
  font-size:18px;margin-bottom:10px;color:#d60000;
}

/* NEW TOP RIGHT CLOSE BUTTON */
.top-close-btn{
  position:absolute;
  top:10px;
  right:10px;
  background:#d60000;
  color:#fff;
  width:28px;
  height:28px;
  font-size:16px;
  border:none;
  border-radius:50%;
  cursor:pointer;
  font-weight:bold;
  line-height:28px;
  text-align:center;
}

.popup-close{
  background:#d60000;color:#fff;padding:8px 14px;
  border-radius:6px;margin-top:15px;width:100%;
  border:none;font-size:14px;cursor:pointer;
}

footer{
  background:#111;color:#ccc;text-align:center;padding:12px;font-size:12px;margin-top:20px;
}
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="logo">Dungarpur Live News <div class="live-dot"></div></div>
  <div class="time-box">
    <span id="live-date"></span><br>
    <span id="live-time"></span>
  </div>
</header>

<!-- TIME -->
<script>
function updateDateTime(){
  const now = new Date();
  const day = now.getDate();
  const month = now.toLocaleString('en-US',{month:'short'});
  const year = now.getFullYear();
  let h=now.getHours(), m=now.getMinutes();
  let ampm=h>=12?"PM":"AM"; h=h%12 || 12;
  m=m<10?"0"+m:m;
  document.getElementById('live-date').innerText = `${day} ${month} ${year}`;
  document.getElementById('live-time').innerText = `${h}:${m} ${ampm}`;
}
setInterval(updateDateTime,1000);
updateDateTime();
</script>

<!-- TICKER -->
<div class="tile-ticker">
  <div class="tile-track" id="tileTrack">Loading...</div>
</div>

<h2 class="section-title" style="font-size:18px;font-weight:700;margin:20px 12px 10px;border-left:5px solid #d60000;padding-left:10px;">
  Latest Video News
</h2>

<div class="grid" id="videoGrid"></div>

<!-- POPUP -->
<div class="popup-bg" id="popupBg">
  <div class="popup-box">
    <button class="top-close-btn" onclick="closePopup()">×</button>
    <h2 id="popupTitle"></h2>
    <p id="popupDesc"></p>
    <button class="popup-close" onclick="closePopup()">Close</button>
  </div>
</div>

<footer>© 2025 Dungarpur Live News</footer>

<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/1XJ8pFXSaWjukPMk8aB2XD3v8mINjoV9n3QqnF02aa-Q/gviz/tq?tqx=out:json";

function openPopup(title, desc){
  document.getElementById("popupTitle").innerText = title;
  document.getElementById("popupDesc").innerText = desc;
  document.getElementById("popupBg").style.display = "flex";
}

function closePopup(){
  document.getElementById("popupBg").style.display = "none";
}

async function loadSheet(){
  let res = await fetch(sheetURL);
  let text = await res.text();
  let json = JSON.parse(text.substring(text.indexOf("{"), text.lastIndexOf("}")+1));
  let rows = json.table.rows;

  let videoHTML = "";
  let tilesHTML = "";

  rows.reverse();

  rows.forEach(r => {
    let title = r.c[0]?.v || "";
    let videoUrl = r.c[1]?.v || "";
    let desc = r.c[2]?.v || "";
    let thumb = r.c[3]?.v || "";

    if(title){
      tilesHTML += `<span class="tile">${title}</span>`;
    }

    videoHTML += `
      <div class="video-card">
        <video controls poster="${thumb}">
          <source src="${videoUrl}">
        </video>

        <h3 onclick="openPopup('${title.replace(/'/g,"")}', \`${desc.replace(/`/g,"")}\`)">${title}</h3>

        <span class="read-more-btn" onclick="openPopup('${title.replace(/'/g,"")}', \`${desc.replace(/`/g,"")}\`)">Read More</span>
      </div>`;
  });

  document.getElementById("videoGrid").innerHTML = videoHTML;
  document.getElementById("tileTrack").innerHTML = tilesHTML + tilesHTML;
}
loadSheet();
</script>

</body>
</html>
